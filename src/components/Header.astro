---
// src/components/Header.astro
import logoImage from "../assets/logo.png";
import logoWord from "../assets/logo-word.png";
import DropdownMenu from "./DropdownMenu.astro";
// import bgPattern from '../assets/bg-pattern.svg'; // (可选) 如果你有背景纹理图片

const desktopLinks = [
  { name: "我的产品", path: "/products" },
  { name: "我的服务", path: "/services" },
  { name: "我们的优势", path: "/advantages" },
  { name: "咖啡小店2.0", path: "/coffee-academy" },
  { name: "合作案例", path: "/scenarios" },
];

const mobileLinks = [
  { name: "首页", path: "/" },
  ...desktopLinks,
  { name: "关于我们", path: "/#about-us" },
  { name: "咖啡学院", path: "/#coffee-academy" },
  { name: "成为合伙人", path: "/#partner" },
];
---

<header class="bg-white/80 backdrop-blur-md shadow-sm sticky top-0 z-40">
  <nav class="container mx-auto px-6 flex justify-between items-center h-20">
    <!-- Logo 区域 -->
    <a href="/" class="flex items-center gap-6">
      <img src={logoImage.src} alt="Obubu Logo" class="h-20 md:h-20" />
      <img
        src={logoWord.src}
        alt="Obubu Logo Word"
        class="sm:inline-block h-7 md:h-8"
      />
    </a>

    <!-- 桌面端链接 -->
    <div class="hidden md:flex items-center gap-8 text-base font-medium">
      {
        desktopLinks.map((link) => (
          <a
            href={link.path}
            class="text-gray-600 hover:text-brand-brown transition-colors"
          >
            {link.name}
          </a>
        ))
      }
      <DropdownMenu />
      <a
        href="/partner"
        class="bg-brand-brown text-white px-5 py-2.5 rounded-md hover:opacity-90 transition text-sm font-semibold"
        >成为合伙人</a
      >
    </div>

    <!-- 移动端汉堡按钮 (md以下显示) -->
    <div class="md:hidden">
      <button
        id="mobile-menu-open-button"
        aria-label="Open menu"
        class="p-2 text-gray-800"
      >
        <svg
          class="w-7 h-7"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
          ><path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16"></path></svg
        >
      </button>
    </div>
  </nav>
</header>

<div
  id="mobile-menu-overlay"
  class="fixed inset-0 bg-black/40 z-40
  transition-opacity duration-300 ease-in-out
  opacity-0 invisible"
>
</div>

<div
  id="mobile-menu-drawer"
  class="fixed top-0 right-0 h-full w-4/5 max-w-sm
  bg-[#a1887f] z-50 p-8 shadow-2xl
  flex flex-col
  transform translate-x-full
  transition-transform duration-300 ease-in-out"
>
  <div class="flex justify-end mb-12">
    <button
      id="mobile-menu-close-button"
      aria-label="Close menu"
      class="p-2 text-white"
    >
      <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"
        ><path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M6 18L18 6M6 6l12 12"></path></svg
      >
    </button>
  </div>

  <!-- 导航链接 -->
  <nav class="flex flex-col items-start gap-6">
    {
      mobileLinks.map((link, index) => (
        <a
          href={link.path}
          class="text-2xl font-semibold text-white transition-colors hover:opacity-80"
        >
          {link.name}
          {index === 0 && <hr class="w-16 mt-2 border-white/50" />}
        </a>
      ))
    }
  </nav>
</div>

<script>
  const openBtn = document.getElementById("mobile-menu-open-button");
  const closeBtn = document.getElementById("mobile-menu-close-button");
  const drawer = document.getElementById("mobile-menu-drawer");
  const overlay = document.getElementById("mobile-menu-overlay");

  function openMenu() {
    overlay?.classList.remove("opacity-0", "invisible");
    drawer?.classList.remove("translate-x-full");
    document.body.style.overflow = "hidden";
  }

  function closeMenu() {
    overlay?.classList.add("opacity-0", "invisible");
    drawer?.classList.add("translate-x-full");
    document.body.style.overflow = "";
  }

  openBtn?.addEventListener("click", openMenu);
  closeBtn?.addEventListener("click", closeMenu);
  overlay?.addEventListener("click", closeMenu);

  drawer?.querySelectorAll("a").forEach((link) => {
    link.addEventListener("click", closeMenu);
  });
</script>
